[gd_scene load_steps=5 format=3 uid="uid://bq6uqbalcvwc5"]

[ext_resource type="Texture2D" uid="uid://bxtf1vlpbd3j1" path="res://ship2.png" id="1_4flbx"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_4flbx"]
friction = 0.0
bounce = 0.5

[sub_resource type="GDScript" id="GDScript_4flbx"]
script/source = "extends RigidBody2D

@export var max_speed : float = 200

# Movement
func _physics_process(delta: float) -> void:
	if not (Input.is_action_pressed(\"Left\") and Input.is_action_pressed(\"Right\")):
		apply_central_force(Vector2(0, -500).rotated(rotation))
		if Input.is_action_pressed(\"Left\"):
			apply_torque(-1500)
		elif Input.is_action_pressed(\"Right\"):
			apply_torque(1500)
	
	pass

#Tile interactions
func _integrate_forces(state: PhysicsDirectBodyState2D) -> void:
	state.angular_velocity = clamp(state.angular_velocity, -2 * PI, 2 * PI)
	
	
	var tiledata : TileData
	if state.get_contact_count() > 0:
		var collider = state.get_contact_collider_object(0)
		if collider.is_in_group(\"Tilemap\"):
			var tilemap : TileMapLayer = collider
			var rid = state.get_contact_collider(0)
			var tilepos = tilemap.get_coords_for_body_rid(rid)
			tiledata = tilemap.get_cell_tile_data(tilepos)
	
	if not tiledata: 
		return
	
	var tiletype = tiledata.get_custom_data(\"type\")
	if tiletype:
		print(state.get_contact_local_normal(1))
		if tiletype == \"Bounce\":
			rotation += 0.5 * PI
		
		
		
		
	
"

[sub_resource type="CircleShape2D" id="CircleShape2D_4flbx"]
radius = 8.06226

[node name="Player" type="RigidBody2D"]
physics_material_override = SubResource("PhysicsMaterial_4flbx")
gravity_scale = 0.0
continuous_cd = 2
contact_monitor = true
max_contacts_reported = 2
linear_damp = 1.5
angular_damp = 5.0
script = SubResource("GDScript_4flbx")

[node name="Sprite" type="Sprite2D" parent="."]
self_modulate = Color(2, 2, 2, 1)
position = Vector2(0, -4)
texture = ExtResource("1_4flbx")

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(2, 2)
position_smoothing_enabled = true

[node name="CPUParticles2D" type="CPUParticles2D" parent="."]
z_index = -1
position = Vector2(0, 3)
amount = 50
lifetime = 3.0
randomness = 1.0
emission_shape = 3
emission_rect_extents = Vector2(3, 3)
direction = Vector2(0, 1)
spread = 10.0
gravity = Vector2(0, 0)
scale_amount_min = 2.0
scale_amount_max = 2.0
color = Color(0.47788, 0.47788, 0.47788, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -2)
shape = SubResource("CircleShape2D_4flbx")
